<!doctype html>
<html ng-app="kakaoApp">
<head>
    <title>Kakao Developer</title>
    <meta charset="utf-8">
    <link rel="stylesheet" href="css/main.css">
    <link rel="stylesheet" href="css/countLetters.css">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.6/css/bootstrap.min.css" integrity="sha384-rwoIResjU2yc3z8GV/NPeZWAv56rSmLldC3R/AZzGRnGxQQKnKkoFVhFQhNUwEyJ" crossorigin="anonymous">

    <script src="https://code.jquery.com/jquery-3.1.1.slim.min.js" integrity="sha384-A7FZj7v+d/sdmMqp/nOQwliLvUsJfDHW+k9Omg/a/EheAdgtzNs3hpfag6Ed950n" crossorigin="anonymous"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.6.4/angular.min.js"></script>
    <script src="https://d3js.org/d3.v4.min.js"></script>

    <script src="Scripts/d3pie/d3pie.min.js"></script>
    <script src="Scripts/d3pie/pieInit.js"></script>
</head>
<body ng-controller="lettersController">
    <div class="page-container">
        <div class="navbar navbar-inverse navbar-fixed-top">
            <div class="_container">
                <div class="navbar-header">
                    <div class="row">
                        <div class="col-md-4">
                            <img id="CocaoLogo" src="Images/cocao.png" />
                            <h1 style="padding-top: 72px;">Kakao Developer</h1>
                        </div>
                        <div class="col-md-6 left" id="contacts">
                            <ul>
                                <li>email: kakaosb@yandex.ru</li>
                                <li>skype: Kakao Developer</li>
                                <li>phone: +7(909)753-66-13</li>
                            </ul>
                        </div>
                        Language: Eng
                    </div>
                </div>
            </div>
        </div>
        <div class="content">
            <br />
            <br />
            <h2>Count letters in a text</h2>

            <div class="row">
                <div class="col-md-4">
                    <div class="form-horizontal" style="margin-top: 60px;">
                        <div class="form-group">
                            <textarea id="textArea" ng-model="lettersArray" placeholder="Enter english text here..." ng-change="addLetters()">                                                               
                            </textarea>
                        </div>
                    </div>

                    <h3>Count a = {{CountA}}</h3>
                    <h3>Count b = {{CountB}}</h3>
                    <h3>Count c = {{CountC}}</h3>
                    <br />
                    <br />


                    <ul>
                        Technologies used:
                        <li>AngularJS</li>
                        <li>D3.js</li>
                        <li>Bootstrap</li>
                    </ul>
                </div>
                <div class="col-md-4">
                    <div id="pieChart"></div>
                </div>
            </div>
        </div>
        <script>
            var kakaoApp = angular.module("kakaoApp", []);
                      
            kakaoApp.controller("lettersController", function ($scope, $q) {
                $scope.lettersArray = "William Shakespeare was baptized on April 26, 1564, in Stratford-upon-Avon, England. From roughly 1594 onward he was an important member of the Lord Chamberlain’s Men company of theatrical players";
                $scope.CountA = 0;
                $scope.CountB = 0;
                $scope.CountC = 0;

                $scope.$watchGroup(['CountA', 'CountB', 'CountC'], function () {
                    reDrawChart();
                });
                           
                $scope.addLetters = function () {
                    var array = $scope.lettersArray;

                    $scope.CountA = GetCountLettersInText(array, "a");
                    $scope.CountB = GetCountLettersInText(array, "b");
                    $scope.CountC = GetCountLettersInText(array, "c");
                };

                $scope.addLetters();

                function reDrawChart() {
                    $("#pieChart").empty();

                    CreatePie($scope.CountA, $scope.CountB, $scope.CountC);
                };

                function GetCountLettersInText(text, char) {
                    return text                        
                        .split(char)
                        .length - 1;
                }
            });
        </script>
</body>

</html>