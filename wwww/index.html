<!doctype html>
<html ng-app="kakaoApp">
<head>
    <title>Kakao Developer</title>
    <meta charset="utf-8">
    <link rel="stylesheet" href="css/main.css">  
    
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.6/css/bootstrap.min.css" integrity="sha384-rwoIResjU2yc3z8GV/NPeZWAv56rSmLldC3R/AZzGRnGxQQKnKkoFVhFQhNUwEyJ" crossorigin="anonymous">
    <script src="https://code.jquery.com/jquery-3.1.1.slim.min.js" integrity="sha384-A7FZj7v+d/sdmMqp/nOQwliLvUsJfDHW+k9Omg/a/EheAdgtzNs3hpfag6Ed950n" crossorigin="anonymous"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.6.4/angular.min.js"></script>
    <script src="https://d3js.org/d3.v4.min.js"></script>

    <script src="Scripts/d3pie/d3pie.min.js"></script>
</head>
<body ng-controller="literalController">
    <div class="page-container">
        <div class="navbar navbar-inverse navbar-fixed-top">
            <div class="_container">
                <div class="navbar-header">
                    <img id="CocaoLogo" src="Images/cocao.png" />
                    <h1 style="padding-top: 72px;">Kakao Developer</h1>
                </div>
            </div>
        </div>
        <div class="content" style="text-align: center">
            <div class="form-horizontal" style="margin-top: 60px;">
                <div class="form-group">
                    <textarea id="textArea" ng-model="literalArray" ng-change="addL()" placeholder="Текст набирать здесь..." style="min-width: 600px"> </textarea>
                </div>
            </div>

            <h3 style="word-wrap:break-word">Entry text: {{literalArray}}</h3>
            <h3>Count A = {{CountA}}</h3>
            <h3>Count B = {{CountB}}</h3>
            <h3>Count C = {{CountC}}</h3>

            <div id="pieChart"></div>
        </div>
    </div>
    <script>
        var kakaoApp = angular.module("kakaoApp", []);
        var pieee;

        kakaoApp.controller("literalController", function ($scope, $q) {
            $scope.literalArray;
            $scope.CountA;
            $scope.CountB;
            $scope.CountC;

            $scope.addL = function () {
                var array = $scope.literalArray;

                $scope.CountA = GetCountLiteralInText(array, "a");
                $scope.CountB = GetCountLiteralInText(array, "b");
                $scope.CountC = GetCountLiteralInText(array, "c");

                $("#pieChart").empty();
                CreatePie($scope.CountA, $scope.CountB, $scope.CountC);
            };

            function GetCountLiteralInText(text, char) {
                return text
                    .toLowerCase()
                    .split(char)
                    .length - 1;
            }
        });

        function CreatePie(countA, countB, countC) {
            var pie = new d3pie("pieChart", {
                "header": {
                    "title": {
                        "text": "Count literal",
                        "fontSize": 24,
                        "font": "open sans"
                    },
                    "subtitle": {
                        "color": "#999999",
                        "fontSize": 12,
                        "font": "open sans"
                    },
                    "titleSubtitlePadding": 9
                },
                "footer": {
                    "color": "#999999",
                    "fontSize": 10,
                    "font": "open sans",
                    "location": "bottom-left"
                },
                "size": {
                    "canvasWidth": 590,
                    "pieOuterRadius": "90%"
                },
                "data": {
                    "sortOrder": "value-desc",
                    "content": [
                        {
                            "label": "A",
                            "value": countA,
                            "color": "#06f033"
                        },
                        {
                            "label": "B",
                            "value": countB,
                            "color": "#2900f3"
                        },
                        {
                            "label": "C",
                            "value": countC,
                            "color": "#ff0000"
                        }
                    ]
                },
                "labels": {
                    "outer": {
                        "pieDistance": 32
                    },
                    "inner": {
                        "hideWhenLessThanPercentage": 3
                    },
                    "mainLabel": {
                        "fontSize": 11
                    },
                    "percentage": {
                        "color": "#ffffff",
                        "decimalPlaces": 0
                    },
                    "value": {
                        "color": "#adadad",
                        "fontSize": 11
                    },
                    "lines": {
                        "enabled": true
                    },
                    "truncation": {
                        "enabled": true
                    }
                },
                "effects": {
                    "pullOutSegmentOnClick": {
                        "effect": "linear",
                        "speed": 400,
                        "size": 8
                    }
                },
                "misc": {
                    "gradient": {
                        "enabled": true,
                        "percentage": 100
                    }
                }
            });

            pieee = pie;
        };

        function CreatePie(countA, countB, countC) {
            var pie = new d3pie("pieChart", {
                "header": {
                    "title": {
                        "text": "Count literal",
                        "fontSize": 24,
                        "font": "open sans"
                    },
                    "subtitle": {
                        "color": "#999999",
                        "fontSize": 12,
                        "font": "open sans"
                    },
                    "titleSubtitlePadding": 9
                },
                "footer": {
                    "color": "#999999",
                    "fontSize": 10,
                    "font": "open sans",
                    "location": "bottom-left"
                },
                "size": {
                    "canvasWidth": 590,
                    "pieOuterRadius": "90%"
                },
                "data": {
                    "sortOrder": "value-desc",
                    "content": [
                        {
                            "label": "A",
                            "value": countA,
                            "color": "#06f033"
                        },
                        {
                            "label": "B",
                            "value": countB,
                            "color": "#2900f3"
                        },
                        {
                            "label": "C",
                            "value": countC,
                            "color": "#ff0000"
                        }
                    ]
                },
                "labels": {
                    "outer": {
                        "pieDistance": 32
                    },
                    "inner": {
                        "hideWhenLessThanPercentage": 3
                    },
                    "mainLabel": {
                        "fontSize": 11
                    },
                    "percentage": {
                        "color": "#ffffff",
                        "decimalPlaces": 0
                    },
                    "value": {
                        "color": "#adadad",
                        "fontSize": 11
                    },
                    "lines": {
                        "enabled": true
                    },
                    "truncation": {
                        "enabled": true
                    }
                },
                "effects": {
                    "pullOutSegmentOnClick": {
                        "effect": "linear",
                        "speed": 400,
                        "size": 8
                    }
                },
                "misc": {
                    "gradient": {
                        "enabled": true,
                        "percentage": 100
                    }
                }
            });

            pieee = pie;
        };

    </script>
</body>

</html>